(function(a,c,b){a.fn.paging=function(f,g){var e=this,d={setOptions:function(e){function d(i){var j=0,e=0,g=1,c={fstack:[],asterisk:0,inactive:0,blockwide:5,current:3,rights:0,lefts:0},a,h=/[*<>pq\[\]().-]|[nc]+!?/g,f={"[":"first","]":"last","<":"prev",">":"next",q:"left",p:"right","-":"fill",".":"leap"},d={};while(a=h.exec(i)){a=String(a);if(b===f[a]){if("("===a)e=++j;else if(")"===a)e=0;else if(g){if("*"===a){c.asterisk=1;c.inactive=0}else{c.asterisk=0;c.inactive="!"===a.charAt(a.length-1);c.blockwide=a.length-c.inactive;if(!(c.current=1+a.indexOf("c")))c.current=1+c.blockwide>>1}c.fstack[c.fstack.length]={ftype:"block",fgroup:0,fpos:0};g=0}}else{c.fstack[c.fstack.length]={ftype:f[a],fgroup:e,fpos:b===d[a]?(d[a]=1):++d[a]};if("q"===a)++c.lefts;else if("p"===a)++c.rights}}return c}this.opts=a.extend(this.opts||{lapping:0,perpage:10,page:1,refresh:{interval:10,url:null},format:"",onFormat:function(){},onSelect:function(){return true},onRefresh:function(){}},e||{});this.opts.lapping|=0;this.opts.perpage|=0;this.opts.page|=0;if(this.opts.perpage<1)this.opts.perpage=10;this.interval&&c.clearInterval(this.interval);if(this.opts.refresh.url)this.interval=c.setInterval(function(b){a.ajax({url:b.opts.refresh.url,success:function(c){if(typeof c==="string")try{c=a.parseJSON(c)}catch(b){return}b.opts.onRefresh(c)}})},1e3*this.opts.refresh.interval,this);this.format=d(this.opts.format);return this},setNumber:function(a){this.number=b===a||a<0?-1:a;return this},setPage:function(g){if(b===g){if(g=this.opts.page,null===g)return this}else if(this.opts.page==g)return this;this.opts.page=g|=0;var n=this.number,m=this.opts,l,p,h,q,t=1,i=this.format,f,k,j,o,u=i.fstack.length,r=u;if(m.perpage<=m.lapping)m.lapping=m.perpage-1;o=n<=m.lapping?0:m.lapping|0;if(n<0){n=-1;h=-1;l=Math.max(1,g-i.current+1-o);p=l+i.blockwide}else{h=1+Math.ceil((n-m.perpage)/(m.perpage-o));g=Math.max(1,Math.min(g<0?1+h+g:g,h));if(i.asterisk){l=1;p=1+h;i.current=g;i.blockwide=h}else{l=Math.max(1,Math.min(g-i.current,h-i.blockwide)+1);p=i.inactive?l+i.blockwide:Math.min(l+i.blockwide,1+h)}}while(r--){k=0;j=i.fstack[r];switch(j.ftype){case"left":k=j.fpos<l;break;case"right":k=p<=h-i.rights+j.fpos;break;case"first":k=i.current<g;break;case"last":k=i.blockwide<i.current+h-g;break;case"prev":k=1<g;break;case"next":k=g<h}t|=k<<j.fgroup}f={number:n,lapping:o,pages:h,perpage:m.perpage,page:g,slice:[(k=g*(m.perpage-o)+o)-m.perpage,Math.min(k,n)]};q="";function s(c,b,a){a=String(c.onFormat.call(b,a));if(b.value)q+=a.replace("<a",'<a data-page="'+b.value+'"');else q+=a}while(++r<u){j=i.fstack[r];k=t>>j.fgroup&1;switch(j.ftype){case"block":for(;l<p;++l){f.value=l;f.pos=1+i.blockwide-p+l;f.active=l<=h||n<0;f.first=1===l;f.last=l==h&&0<n;s(m,f,j.ftype)}continue;case"left":f.value=j.fpos;f.active=j.fpos<l;break;case"right":f.value=h-i.rights+j.fpos;f.active=p<=f.value;break;case"first":f.value=1;f.active=k&&1<g;break;case"prev":f.value=Math.max(1,g-1);f.active=k&&1<g;break;case"last":if(f.active=n<0)f.value=1+g;else{f.value=h;f.active=k&&g<h}break;case"next":if(f.active=n<0)f.value=1+g;else{f.value=Math.min(1+g,h);f.active=k&&g<h}break;case"leap":case"fill":f.pos=j.fpos;f.active=k;s(m,f,j.ftype);continue}f.pos=j.fpos;f.last=f.first=b;s(m,f,j.ftype)}if(e.length){a("a",e.html(q)).click(function(e){e.preventDefault();var b=this;do if("a"===b.nodeName.toLowerCase())break;while(b=b.parentNode);d.setPage(a(b).data("page"));if(d.locate)c.location=b.href});this.locate=m.onSelect.call({number:n,lapping:o,pages:h,slice:f.slice},g)}return this}};return d.setNumber(f).setOptions(g).setPage()}})(jQuery,this);